<!doctype html>
<html lang="ko" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-project docs-doc-id-system-design-interview/nine" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">09. 웹 크롤러 설계 | Woosuk Kwon</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://egg528.github.io/project/system-design-interview/nine"><meta data-rh="true" name="docusaurus_locale" content="ko"><meta data-rh="true" name="docsearch:language" content="ko"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-project-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-project-current"><meta data-rh="true" property="og:title" content="09. 웹 크롤러 설계 | Woosuk Kwon"><meta data-rh="true" name="description" content="1. 웹 크롤러란?"><meta data-rh="true" property="og:description" content="1. 웹 크롤러란?"><link data-rh="true" rel="icon" href="/img/egg.png"><link data-rh="true" rel="canonical" href="https://egg528.github.io/project/system-design-interview/nine"><link data-rh="true" rel="alternate" href="https://egg528.github.io/project/system-design-interview/nine" hreflang="ko"><link data-rh="true" rel="alternate" href="https://egg528.github.io/project/system-design-interview/nine" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Woosuk Kwon RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Woosuk Kwon Atom Feed"><link rel="stylesheet" href="/assets/css/styles.b357c7f2.css">
<link rel="preload" href="/assets/js/runtime~main.9c08fabc.js" as="script">
<link rel="preload" href="/assets/js/main.8dc4f9ee.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="본문으로 건너뛰기"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">본문으로 건너뛰기</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Home</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">PARA Note</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/project/intro">Project</a></li><li><a class="dropdown__link" href="/area/intro">Area</a></li><li><a class="dropdown__link" href="/resource/intro">Resource</a></li><li><a class="dropdown__link" href="/archive/intro">Archive</a></li></ul></div><a href="https://egg528.github.io/pdf/resume.pdf" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Resume<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="맨 위로 스크롤하기" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><b>Home</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/project/intro">➡️ Project</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/project/Cache-Abstraction">Cache Abstraction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">이펙티브 타입스크립트</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/effective-typescript/one">1장 타입스크립트 알아보기 (Item 1 ~ 5)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/effective-typescript/two">2장 타입 스크립트의 타입 시스템  (Item 6 ~ 18)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">spring batch</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/spring-batch/one">Introduction</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">대규모 시스템 설계 기초</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/system-design-interview/one">01. 사용자 수에 따른 규모 확장성</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/system-design-interview/two">02. 개략적인 규모 추정</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/system-design-interview/three">03. 시스템 설계 면접 공략법</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/system-design-interview/four">04. 처리율 제한 장치의 설계</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/system-design-interview/five">05. 안정 해시 설계</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/system-design-interview/six">06. key-value 저장소 설계</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/system-design-interview/seven">07. 분산 시스템을 위한 유일 ID 생성기 설계</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/system-design-interview/eight">08. URL 단축기 설계</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/project/system-design-interview/nine">09. 웹 크롤러 설계</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/system-design-interview/ten">10. 알림 시스템 설계</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/system-design-interview/eleven">11. 뉴스 피드 시스템</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/system-design-interview/thirteen">13. 검색어 자동완성 시스템</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="홈" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">대규모 시스템 설계 기초</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">09. 웹 크롤러 설계</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">이 페이지에서</button></div><div class="theme-doc-markdown markdown"><header><h1>09. 웹 크롤러 설계</h1></header><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-웹-크롤러란">1. 웹 크롤러란?<a href="#1-웹-크롤러란" class="hash-link" aria-label="1. 웹 크롤러란?에 대한 직접 링크" title="1. 웹 크롤러란?에 대한 직접 링크">​</a></h2><ul><li>웹에 올라오거나 갱신된 콘텐츠를 찾아내는 목적을 가진 프로그램</li><li>여기서 콘텐츠는 다양한 형식일 수 있음(web page, pdf, image ...)</li><li>사용 예시: 검색 엔진 인덱싱, 웹 아카이빙, 웹 마이닝, 웹 모니터링</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-설계-시-고민할-것들">2. 설계 시 고민할 것들<a href="#2-설계-시-고민할-것들" class="hash-link" aria-label="2. 설계 시 고민할 것들에 대한 직접 링크" title="2. 설계 시 고민할 것들에 대한 직접 링크">​</a></h2><ul><li>웹 크롤러의 목적</li><li>수집이 필요한 웹 페이지의 규모</li><li>웹 페이지 형식 변화에 대한 대응 여부</li><li>웹 페이지 저장 여부 및 보관 기간</li><li>중복된 컨텐츠 처리 여부 등...</li><li>규모 확장성, 안정성, 수집 대상 웹 페이지 요청 수, 수집 콘텐츠의 확장성 등등...</li></ul><p>계
<img loading="lazy" alt="web_crawler.jpg" src="/assets/images/web_crawler-2beae46248e7361b658657837f546b1b.jpg" width="1602" height="1038" class="img_ev3q"></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-시작-url-집합">(1) 시작 URL 집합<a href="#1-시작-url-집합" class="hash-link" aria-label="(1) 시작 URL 집합에 대한 직접 링크" title="(1) 시작 URL 집합에 대한 직접 링크">​</a></h3><ul><li>웹 크롤러가 크롤링을 시작하는 출발점들의 집합</li><li>대개 수집할 전체 URL 공간을 작은 부분집합으로 나누는 전략을 사용한다. (지역, 주제 등등..)</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-미수집-url-저장소">(2) 미수집 URL 저장소<a href="#2-미수집-url-저장소" class="hash-link" aria-label="(2) 미수집 URL 저장소에 대한 직접 링크" title="(2) 미수집 URL 저장소에 대한 직접 링크">​</a></h3><ul><li>크롤링 상태를 관리하기 위해 URL을 다운로드 할 URL / 다운로드된 URL로 나눈다.</li><li>이 중에서 다운로드 할 URL을 저장 관리하는 컴포넌트가 미수집 URL 저장소이다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-html-다운로더">(3) HTML 다운로더<a href="#3-html-다운로더" class="hash-link" aria-label="(3) HTML 다운로더에 대한 직접 링크" title="(3) HTML 다운로더에 대한 직접 링크">​</a></h3><ul><li>말 그대로 URL을 인자로 받아 콘텐츠를 다운로드하는 컴포넌트이다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4-도메인-이름-변환기">(4) 도메인 이름 변환기<a href="#4-도메인-이름-변환기" class="hash-link" aria-label="(4) 도메인 이름 변환기에 대한 직접 링크" title="(4) 도메인 이름 변환기에 대한 직접 링크">​</a></h3><ul><li>URL을 대응되는 IP로 변환하는 컴포넌트이다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5-콘텐츠-파서">(5) 콘텐츠 파서<a href="#5-콘텐츠-파서" class="hash-link" aria-label="(5) 콘텐츠 파서에 대한 직접 링크" title="(5) 콘텐츠 파서에 대한 직접 링크">​</a></h3><ul><li>다운받은 콘텐츠를 parsing하고 validation하는 역할을 담당한다.</li><li>원하는 형식의 데이터를 걸러내는 작업을 진행한다.</li><li>크롤링 서버 내에 콘텐츠 파서를 구현하면 크롤링 과정이 느려짐으로 별도의 컴포넌트로 두는 것도 고려할 수 있다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6-중복-콘텐츠-여부">(6) 중복 콘텐츠 여부<a href="#6-중복-콘텐츠-여부" class="hash-link" aria-label="(6) 중복 콘텐츠 여부에 대한 직접 링크" title="(6) 중복 콘텐츠 여부에 대한 직접 링크">​</a></h3><ul><li>책에 의하면 29%가량의 웹 콘텐츠는 중복이라고 한다.</li><li>때문에 적합한 자료 구조를 도입하여 중복과 데이터 처리 소요 시간을 줄이는 컴포넌트이다.</li><li>HTML 비교에 가장 직관적인 방법은 문자열 비교이겠지만, 큰 규모에서 성능을 고려한다면 책에서는 Hash값 비교를 추천한다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="7-콘텐츠-저장소">(7) 콘텐츠 저장소<a href="#7-콘텐츠-저장소" class="hash-link" aria-label="(7) 콘텐츠 저장소에 대한 직접 링크" title="(7) 콘텐츠 저장소에 대한 직접 링크">​</a></h3><ul><li>수집한 콘텐츠를 저장하는 시스템</li><li>콘텐츠 유형, 크기, 접근 빈도, 보관 기간 등을 고려하여 선택할 수 있다.</li><li>책에서는 디스크와 메모리를 동시에 사용하는 저장소를 택했다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="8-url-추출기">(8) URL 추출기<a href="#8-url-추출기" class="hash-link" aria-label="(8) URL 추출기에 대한 직접 링크" title="(8) URL 추출기에 대한 직접 링크">​</a></h3><ul><li>HTML 페이지를 파싱하여 링크들을 골라내는 역할을 한다.</li><li>예를 들면 상대 경로에 도메인을 추가하여 절대 경로로 변환하는 역할이다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="9-url-필터">(9) URL 필터<a href="#9-url-필터" class="hash-link" aria-label="(9) URL 필터에 대한 직접 링크" title="(9) URL 필터에 대한 직접 링크">​</a></h3><ul><li>특정한 콘텐츠 타입나 파일 확장자, 오류가 발생하는 URL, 접근 제외 목록에 포함된 URL을 크롤링 대상에서 제외하는 역할을 담당한다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="10-이미-방문한-url-여부">(10) 이미 방문한 URL 여부<a href="#10-이미-방문한-url-여부" class="hash-link" aria-label="(10) 이미 방문한 URL 여부에 대한 직접 링크" title="(10) 이미 방문한 URL 여부에 대한 직접 링크">​</a></h3><ul><li>다운로드 할 URL / 다운로드된 URL을 바탕으로 이미 방문한 URL을 거르는 컴포넌트이다.</li><li>책에서는 자료 구조를 통해 다운로드 할 URL / 다운로드된 URL를 관리한다.</li><li>해당 컴포넌트를 통해 서버 주하를 줄이고 무한 루프를 방지할 수 있다.</li><li>자료 구조로는 블룸 필터 혹은 해시 테이블이 널리 쓰인다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="11-url-저장소">(11) URL 저장소<a href="#11-url-저장소" class="hash-link" aria-label="(11) URL 저장소에 대한 직접 링크" title="(11) URL 저장소에 대한 직접 링크">​</a></h3><ul><li>이미 방문한 URL을 보관하는 저장소이다.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4-상세-설계">4. 상세 설계<a href="#4-상세-설계" class="hash-link" aria-label="4. 상세 설계에 대한 직접 링크" title="4. 상세 설계에 대한 직접 링크">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-dfs-or-bfs">(1) DFS or BFS<a href="#1-dfs-or-bfs" class="hash-link" aria-label="(1) DFS or BFS에 대한 직접 링크" title="(1) DFS or BFS에 대한 직접 링크">​</a></h3><ul><li>웹은 페이지(Node)와 하이퍼링크(Edge)를 가지는 방향성 그래프와 같다.</li><li>때문에 웹 크롤링 프로세스는 방향성 그래프를 탐색하는 과정이다.</li><li>그래프 깊이를 가늠하고 조절하기 위해 대개 DFS보다는 BFS를 사용한다.</li><li>하지만 BFS에는 2가지 문제점이 있다.<ul><li>한 페이지에서 나오는 링크는 대개 같은 서버 위에 동작하기 때문에 서버에 부하를 주게 된다.</li><li>URL 간에 우선순위가 없어 처리 순서에 우선순위를 둘 수 없다.</li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-미수집-url-저장소-1">(2) 미수집 URL 저장소<a href="#2-미수집-url-저장소-1" class="hash-link" aria-label="(2) 미수집 URL 저장소에 대한 직접 링크" title="(2) 미수집 URL 저장소에 대한 직접 링크">​</a></h3><ul><li>미수집 저장소는 다운로드할 URL을 보관하는 장소이다.</li><li>즉, 미수집 URL 저장소를 잘 구현하면 서버에 부하를 줄 수 있고, 우선 순위가 없는 BFS 문제점을 해결할 수 있다.</li><li>안정성, 속도 측면을 고려할 때 미수집 URL 저장소는 디스크와 메모리 혹은 둘을 혼합하는 하이브리드 선택지가 있다.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="예의-바른-웹-크롤러">예의 바른 웹 크롤러<a href="#예의-바른-웹-크롤러" class="hash-link" aria-label="예의 바른 웹 크롤러에 대한 직접 링크" title="예의 바른 웹 크롤러에 대한 직접 링크">​</a></h4><ul><li>짧은 시간 안에 너무 많은 요청을 보내면 대상 서버에 부하를 줄 수 있고 Dos 공격으로 간주될 수도 있음.</li><li>예의 바른 웹 크롤러를 만들기 위해서는 동일 웹 사이트에 대해서는 한 번에 한 페이지만 요청해야 한다.<ul><li>대상 hostname과 작업 스레드 사이의 관계를 유지하면 된다. (작업 스레드는 별도의 FIFO 큐를 가진다.)
<img loading="lazy" alt="polite_web_crawler.jpg" src="/assets/images/polite_web_crawler-cac58db6c4610f6a5d43f6c2bfa4d741.jpg" width="1626" height="1440" class="img_ev3q"></li></ul></li><li>큐 라우터는 host별로 분리하여 Queue에 대상 url을 담는다.</li><li>큐 선택기는 큐를 순회하며 url을 가져와 url별로 지정된 작업 스레드에 할당한다.</li><li>작업 스레드는 전달된 url을 다운로드하며 작업들 사이에는 일정한 지연시간을 유지한다.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="우선순위">우선순위<a href="#우선순위" class="hash-link" aria-label="우선순위에 대한 직접 링크" title="우선순위에 대한 직접 링크">​</a></h4><p><img loading="lazy" alt="rank_system.jpg" src="/assets/images/rank_system-f2c9b600cc06ab7cc91772b0037f0cf3.jpg" width="1758" height="1408" class="img_ev3q"></p><ul><li>크롤러 목적과의 적합성, 트래픽 양, 갱신 빈도 등의 척도에 기반하여 우선순위를 정하고 순차적인 크롤링이 필요할 수 있다.</li><li>이때 위와 같은 순위 결정 장치를 추가하면 된다.</li><li>순위결정장치는 url을 받아 주어진 조건에 따라 순위 별 큐에 URL을 분리하여 담는다.</li><li>큐 선택기는 처리할 url을 반환한다. 이때 순위가 높은 큐에서 더 자주 값을 가져오도록 프로그래밍 되어야 한다.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="신선도">신선도<a href="#신선도" class="hash-link" aria-label="신선도에 대한 직접 링크" title="신선도에 대한 직접 링크">​</a></h4><ul><li>웹 콘텐츠 변경에 따른 데이터 재수집이 필요할 수 있다.</li><li>이때 웹 페이지 변경 이력을 활용하여 재수집을 시도할 수도 있고 우선순위를 활용하여 중요한 페이지는 자주 재수집하는 것을 고려할 수 있다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-html-다운로더-1">(3) HTML 다운로더<a href="#3-html-다운로더-1" class="hash-link" aria-label="(3) HTML 다운로더에 대한 직접 링크" title="(3) HTML 다운로더에 대한 직접 링크">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="robottxt">Robot.txt<a href="#robottxt" class="hash-link" aria-label="Robot.txt에 대한 직접 링크" title="Robot.txt에 대한 직접 링크">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// https://finance.naver.com/robots.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User-agent: *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Disallow: /</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User-agent: yeti</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Disallow: /</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Allow: /sise/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Allow: /research/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Allow: /marketindex/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Allow: /fund/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Allow: /template/head_js.naver</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Disallow : /fund/news/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Disallow : /marketindex/news/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>웹사이트가 크롤러와 소통하는 표준적인 방법이다.</li><li>이 파일에는 수집이 허용된 페이지 목록이 들어있다.</li><li>때문에 크롤러는 웹 사이트 수집 이전에 해당 파일에 정의된 규칙을 확인해야 한다.</li><li>매번 다운받기보다는 캐시하는 것이 성능 상 더 좋다.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="성능-최적화-포인트">성능 최적화 포인트<a href="#성능-최적화-포인트" class="hash-link" aria-label="성능 최적화 포인트에 대한 직접 링크" title="성능 최적화 포인트에 대한 직접 링크">​</a></h4><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="--분산-크롤링">- 분산 크롤링<a href="#--분산-크롤링" class="hash-link" aria-label="- 분산 크롤링에 대한 직접 링크" title="- 분산 크롤링에 대한 직접 링크">​</a></h5><ul><li>미수집 URL 저장소에서 2개 이상의 서버로 URL을 배분하여 제공하고 여러 서버가 처리를 동시에 진행하는 구조</li></ul><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="--도메인-이름-변환-결과-캐시">- 도메인 이름 변환 결과 캐시<a href="#--도메인-이름-변환-결과-캐시" class="hash-link" aria-label="- 도메인 이름 변환 결과 캐시에 대한 직접 링크" title="- 도메인 이름 변환 결과 캐시에 대한 직접 링크">​</a></h5><ul><li>DNS 요청 - 응답 과정은 동기적인 특성이 있어 크롤러의 병목 중 하나이다.</li><li>DNS 처리는 보통 10ms에서 200가 소요됨</li><li>크롤러의 스레드 하나가 이 작업을 수행하면 나머지는 전부 block됨</li><li>때문에 도메인명 - IP 관계를 캐시해두고 주기적으로 갱신한다면 성능을 높일 수 있다.</li></ul><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="--지역성">- 지역성<a href="#--지역성" class="hash-link" aria-label="- 지역성에 대한 직접 링크" title="- 지역성에 대한 직접 링크">​</a></h5><ul><li>수집 대상 서버와 가까운 위치일수록 수집이 빠르다는 점을 고려하여 서버를 지역별로 분산하는 방법.</li></ul><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="--짧은-타임아웃">- 짧은 타임아웃<a href="#--짧은-타임아웃" class="hash-link" aria-label="- 짧은 타임아웃에 대한 직접 링크" title="- 짧은 타임아웃에 대한 직접 링크">​</a></h5><ul><li>응답이 느리거나 없는 경우 이를 무한정 기다리면 크롤러가 동작을 멈추는 경우가 자주 생길 수 있다.</li><li>때문에 짧은 타임 아웃으로 이러한 케이스를 넘길 수 있어야 한다.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="안정성">안정성<a href="#안정성" class="hash-link" aria-label="안정성에 대한 직접 링크" title="안정성에 대한 직접 링크">​</a></h4><ul><li>안정 해시: 이는 서버 추가가 가능하게 만들어 부하를 분산시킬 수 있다.</li><li>크롤링 상태 및 수집 데이터 저장: 장애 발생의 경우 해당 지점부터 재시작이 가능하도록 크롤링 상태 및 수집 데이터를 수시로 저장하는 것이 좋다.</li><li>예외 처리: 예외 발생 시에도 시스템이 동작하도록 고려해야 한다. 항상 그렇듯이 크롤러를 동작시켜가며 발생하는 예외에 대해 고려가 필요할듯</li><li>데이터 검증: validation은 시스템 오류를 방지하기 위한 중요 수단이다</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="확장성">확장성<a href="#확장성" class="hash-link" aria-label="확장성에 대한 직접 링크" title="확장성에 대한 직접 링크">​</a></h4><p><img loading="lazy" alt="extension_system.jpg" src="/assets/images/extension_system-966dff469bb3bc762d268dac29caed61.jpg" width="1590" height="986" class="img_ev3q"></p><ul><li>크롤러가 확장되면서 새로운 타입의 데이터를 수집해야 하는 경우가 발생할 수 있다.</li><li>책에서는 새로운 타입을 다운로드할 수 있는 모듈을 추가하는 방식을 제안한다.</li><li>이렇게 되면 콘텐츠를 구분하는 모듈이 필요할 수도 있을 것 같다.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="문제가-있는-콘텐츠-감지-및-회피">문제가 있는 콘텐츠 감지 및 회피<a href="#문제가-있는-콘텐츠-감지-및-회피" class="hash-link" aria-label="문제가 있는 콘텐츠 감지 및 회피에 대한 직접 링크" title="문제가 있는 콘텐츠 감지 및 회피에 대한 직접 링크">​</a></h4><ul><li>중복 콘텐츠: 해시나 체크섬을 사용하여 중복 콘텐츠를 회피할 수 있다.</li><li>거미 덫: url 최대 길이에 제한을 두어 <a href="http://www.spider.com/foo/foo/foo/foo...%EC%99%80" target="_blank" rel="noopener noreferrer">www.spider.com/foo/foo/foo/foo...와</a> 같은 덫 사이트를 피할 수 있다.<ul><li>만능 방법은 없고 알고리즘을 고민해봐야 한다. 이런 사이트를 찾을 때마다 제외 대상에 추가하는 것도 방법</li></ul></li><li>데이터 노이즈: 가치가 없는 콘텐츠를 검증하는 방식도 고민해볼 필요가 있다,.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5-추가로-고민하면-좋은-주제">5. 추가로 고민하면 좋은 주제<a href="#5-추가로-고민하면-좋은-주제" class="hash-link" aria-label="5. 추가로 고민하면 좋은 주제에 대한 직접 링크" title="5. 추가로 고민하면 좋은 주제에 대한 직접 링크">​</a></h2><ul><li>서버 측 렌더링: 웹사이트에서 링크를 즉석에서 만들어 내는 경우 페이지 파싱 전에 서버 측 렌더링을 적용하여 해결 가능</li><li>원치 않는 페이지 필터링: 자원을 아끼기 위해 스팸 방지 컴포넌트를 두어 불필요한 페이지를 걸러내면 좋다.</li><li>DB 다중화 및 샤딩: 데이터 계층의 가용성, 규모 확장성, 안정성을 위한 기법</li><li>수평적 규모 확장성: 대규모 크롤링을 위한 서버 추가를 고려하여 무상태 서버 개발을 고려할 수 있다.</li><li>가용성, 일관성, 안정성</li><li>데이터 분석 솔루션</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="문서 페이지"><a class="pagination-nav__link pagination-nav__link--prev" href="/project/system-design-interview/eight"><div class="pagination-nav__sublabel">이전</div><div class="pagination-nav__label">08. URL 단축기 설계</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/project/system-design-interview/ten"><div class="pagination-nav__sublabel">다음</div><div class="pagination-nav__label">10. 알림 시스템 설계</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-웹-크롤러란" class="table-of-contents__link toc-highlight">1. 웹 크롤러란?</a></li><li><a href="#2-설계-시-고민할-것들" class="table-of-contents__link toc-highlight">2. 설계 시 고민할 것들</a><ul><li><a href="#1-시작-url-집합" class="table-of-contents__link toc-highlight">(1) 시작 URL 집합</a></li><li><a href="#2-미수집-url-저장소" class="table-of-contents__link toc-highlight">(2) 미수집 URL 저장소</a></li><li><a href="#3-html-다운로더" class="table-of-contents__link toc-highlight">(3) HTML 다운로더</a></li><li><a href="#4-도메인-이름-변환기" class="table-of-contents__link toc-highlight">(4) 도메인 이름 변환기</a></li><li><a href="#5-콘텐츠-파서" class="table-of-contents__link toc-highlight">(5) 콘텐츠 파서</a></li><li><a href="#6-중복-콘텐츠-여부" class="table-of-contents__link toc-highlight">(6) 중복 콘텐츠 여부</a></li><li><a href="#7-콘텐츠-저장소" class="table-of-contents__link toc-highlight">(7) 콘텐츠 저장소</a></li><li><a href="#8-url-추출기" class="table-of-contents__link toc-highlight">(8) URL 추출기</a></li><li><a href="#9-url-필터" class="table-of-contents__link toc-highlight">(9) URL 필터</a></li><li><a href="#10-이미-방문한-url-여부" class="table-of-contents__link toc-highlight">(10) 이미 방문한 URL 여부</a></li><li><a href="#11-url-저장소" class="table-of-contents__link toc-highlight">(11) URL 저장소</a></li></ul></li><li><a href="#4-상세-설계" class="table-of-contents__link toc-highlight">4. 상세 설계</a><ul><li><a href="#1-dfs-or-bfs" class="table-of-contents__link toc-highlight">(1) DFS or BFS</a></li><li><a href="#2-미수집-url-저장소-1" class="table-of-contents__link toc-highlight">(2) 미수집 URL 저장소</a></li><li><a href="#3-html-다운로더-1" class="table-of-contents__link toc-highlight">(3) HTML 다운로더</a></li></ul></li><li><a href="#5-추가로-고민하면-좋은-주제" class="table-of-contents__link toc-highlight">5. 추가로 고민하면 좋은 주제</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contact</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/egg528" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/rnjsdntjr26" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://egg528.github.io/pdf/resume.pdf" target="_blank" rel="noopener noreferrer" class="footer__link-item">Resume<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">PARA Note</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://egg528.github.io/project/intro" target="_blank" rel="noopener noreferrer" class="footer__link-item">Project<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/egg528/area/intro" target="_blank" rel="noopener noreferrer" class="footer__link-item">Area<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/egg528/resource/intro" target="_blank" rel="noopener noreferrer" class="footer__link-item">Resource<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/egg528/archive/intro" target="_blank" rel="noopener noreferrer" class="footer__link-item">Archive<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9c08fabc.js"></script>
<script src="/assets/js/main.8dc4f9ee.js"></script>
</body>
</html>