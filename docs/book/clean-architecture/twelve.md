---
title: 05. 웹 어댑터 구현하기
sidebar_position: 5
---
## 웹 어댑터 구현하기

### 1. 웹 어댑터란?
- 외부와 커뮤니케이션하는 역할
- HTTP API도 어댑터를 구현하는 하나의 방식
- MVC 모델의 Controller와 같은 역할이라고 생각하면 될 것 같다


### 2. 의존성 역전
![web-adapter.png](img/web-adapter.png)
- 웹 어댑터는 application.service에 의해 구현된 전용 포트(interface)를 통해 application.service와 통신한다.
- 이 구조에서 포트는 왜 필요한가?
  - 책의 논리는 포트가 application 계층이 외부와 통신하는 명세서의 역할을 한다고 말한다.
  - application 계층이 어떻게 외부와 통신하는지를 명확하게 남겨 의도를 남길 수 있다.
  - 또한 웹 어댑터는 포트에만 의존하기에 application 계층의 로직 변화에 영향을 받지 않는다.
- 웹 소켓의 경우 웹 어뎁터는 요청을 받는 인커밍 어댑터이자 응답을 능동적으로 내보내는 아웃고잉 어댑터이다.
  - 이 경우 의존성의 방향을 올바르게 유지하기 위해 포트가 필수적이라 말한다.
  - 능동적으로 응답을 보내야 하는 경우 application에서 포트(port.out)를 의존한다. 


### 3. 웹 어댑터의 역할
```
1. HTTP 요청을 Java 객체로 매핑
2. 권한 검사
3. 입력 유효성 검증
4. 입력을 유스케이스의 입력 모델로 매핑
5. 유스케이스 호출
6. 유스케이스의 출력을 HTTP로 매핑
7. HTTP 응답 반환
```
- 3번의 입력 유효성 검증은 유스 케이스 모델의 유효성 검증과는 달라야 한다.
  - 웹 어댑터의 입력 모델을 유스케이스 입력 모델로 변환할 수 있는지를 확인해야 한다. (로직과 관련된 검증이 아닌 데이터 타입 매핑이 가능한지가 하나의 예시가 될듯)
- 또한 HTTP와 관련된 것을 application 계층으로 넘겨서는 안 된다.
  - 이는 도메인 로직의 재사용을 방해한다.

### 4. 컨트롤러 나누기
- Controller는 너무 적은 것보다는 너무 많은 것을 추천한다. (별도의 패키지도)
  - 역할이 좁고, Controller간의 공통점은 최대한 줄이는 방향으로
  - 거대한 클래스를 방지하고, 의미를 분명히하는 효과가 있을 것이다.
  - 또한 Controller가 분리되면 데이터 구조 재활용을 줄일 수 있다. (패키지 내에 두어 패키지 안에서만 사용하도록)
  - 동시 작업에서 merge conflict가 줄어들 수 있다는 점은 보너스.. 
- Controller명과 메서드 명은 UseCase명을 기반으로 만드는 방향으로 먼저 생각해보면 도움이 될듯.