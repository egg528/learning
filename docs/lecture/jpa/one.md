---
title: 1. 연관관계 매핑 기초
sidebar_position: 1
---
# 양방향 연관관계

- 관계형 DB는 외래키 하나로 양방향 연관 관계가 구현된다.
- 하지만 객체의 경우 단방향 2개를 사용해 양방향 연관 관계를 구현해야 한다.
- 여기서 문제가 생긴다.
  - 객체 A와 B가 양방향 연관 관계일 때 A를 수정하려면 객체 A에 접근해야할까, B를 통해 A로 접근해야 할까.
  - `연관 관계의 주인은 항상 외래키를 가진 객체에 둘 것.`
  - 팀과 팀원 객체가 있다면 연관관계의 주인은 팀원이다. (팀원이 팀 id를 외래키로 가지고 있기 때문에)
  - 연관관계의 주인이 아닌 쪽에 mappedby 설정





# 양방향 매핑시 많이 하는 실수

1. 연관관계의 주인에 외래키를 매핑해줘야 한다.
  - Team의 List<Member>에 Member를 추가해도 Member의 TEAM_ID는 수정되지 않음.
2. 순수한 객체 관계를 고려하면 항상 양쪽 다 값을 입력해야 한다.
  - 객체지향적으로 생각하면 양방향 모두에 값이 반영되어 있어야 함.
  - JPA의 영속성 컨텍스트는 기본적으로 캐시를 사용하기 때문에 매번 DB조회를 하지 않는다.
  - 때문에 오류 없이 사용하려면 양쪽 다 값을 반영해야 한다.
  - `양방향 매핑된 필드의 경우 Set메서드에 양쪽 모두에 Set될 수 있도록 로직을 설정할 것`
3. 양방향 매핑은 꼭 필요한 경우에만 사용할 것.
  - 역방향 탐색이 필요할 때만 추가.

